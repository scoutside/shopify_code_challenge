<div>
  <ul class="recharge-product">
  {% for product in collections.all.products limit: 1 %}
      <li>
        <img src="{{ product.featured_image | product_img_url: 'medium' }}" alt="{{ product.title | escape  }}" /> 
        <h3>{{ product.title | escape  }}</h3>
        <p>{{ product.price | money }}</p>   
        <button id="addToCart">Add to Cart</button>
      </li> 
  {% endfor %}
  </ul>
</div>
 

{% schema %}
  {
    "name": "Recharge-Challenge",
    "settings": [
      {
      "type": "product",
      "id": "feature_product",
      "label": "Feature Product"
      }
    ]
  }
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}


const cartButton = document.querySelector('#addToCart');

cartButton.addEventListener('click', () => {
    addItemToCart(15428214784046, 1, "6", "Months", "206908");
});

function addItemToCart (variant_id, quantity, shipping_interval_frequency, shipping_interval_unit_type, subscription_id) {
  data = {
      "quantity": quantity,
      "id": variant_id,
      "properties[shipping_interval_frequency]": shipping_interval_frequency, 
	    "properties[shipping_interval_unit_type]": shipping_interval_unit_type,            
	    "properties[subscription_id]": subscription_id
    }
  jQuery.ajax({
      type: 'POST',
      url: '/cart/add.js',
      data: data,
      dataType: 'json',
      success: function() { 
          window.location.href = 'https://checkout.rechargeapps.com/r/checkout?myshopify_domain=code-challenge.myshopify.com&cart_token=bf9f2ca9feb99cc702deb1a76a15a6de'; 
      }
  });
  window.location = 'https://checkout.rechargeapps.com/r/checkout?myshopify_domain=code-challenge.myshopify.com&cart_token=bf9f2ca9feb99cc702deb1a76a15a6de';
} 

{% endjavascript %}